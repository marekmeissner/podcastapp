1e68fac3b22e1a872added589e6c65b6
"use strict";var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(exports, "__esModule", { value: true });exports.initialiseNativeModuleEventEmitter = exports.getAppEventName = exports.SharedEventEmitter = void 0;var _reactNative = require("react-native");
var _EventEmitter = _interopRequireDefault(require("react-native/Libraries/vendor/emitter/EventEmitter"));
var NATIVE_EMITTERS = {};
var NATIVE_SUBSCRIPTIONS = {};
var SharedEventEmitter = new _EventEmitter.default();exports.SharedEventEmitter = SharedEventEmitter;
var getAppEventName = function getAppEventName(module, eventName) {return module.app.name + "-" + eventName;};exports.getAppEventName = getAppEventName;

var getNativeEmitter = function getNativeEmitter(moduleName, module) {
  var name = module.app.name + "-" + moduleName;
  var nativeModule = _reactNative.NativeModules[moduleName];

  if (!NATIVE_EMITTERS[name]) {
    NATIVE_EMITTERS[name] = new _reactNative.NativeEventEmitter(nativeModule);
  }

  return NATIVE_EMITTERS[name];
};













var subscribeToNativeModuleEvents = function subscribeToNativeModuleEvents(moduleName, module, eventName) {
  if (!NATIVE_SUBSCRIPTIONS[eventName]) {
    var nativeEmitter = getNativeEmitter(moduleName, module);
    nativeEmitter.addListener(eventName, function (event) {
      if (event.appName) {

        SharedEventEmitter.emit(event.appName + "-" + eventName, event);
      } else {

        SharedEventEmitter.emit(eventName, event);
      }
    });
    NATIVE_SUBSCRIPTIONS[eventName] = true;
  }
};

var initialiseNativeModuleEventEmitter = function initialiseNativeModuleEventEmitter(module, config) {var

  events =

  config.events,moduleName = config.moduleName;

  if (events && events.length) {
    for (var i = 0, len = events.length; i < len; i++) {
      subscribeToNativeModuleEvents(moduleName, module, events[i]);
    }
  }
};exports.initialiseNativeModuleEventEmitter = initialiseNativeModuleEventEmitter;